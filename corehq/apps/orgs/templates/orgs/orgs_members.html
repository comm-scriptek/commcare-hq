{% extends "orgs/orgs_landing.html" %}
{% load i18n %}
{% load hq_shared_tags %}

{% block js %}{{ block.super }}
<script src="{% static 'hqwebapp/javascripts/knockout.mapping.js' %}"></script>
<script src="{% static 'hqwebapp/js/knockout-bindings.js' %}"></script>
<script src="{% static 'users/js/roles.js' %}"></script>
<script src="{% static 'users/js/selectText.js' %}"></script>

{% endblock %}
{% block js-inline %}{{ block.super }}
<script>
    $(function () {
                $('#user-roles-table').userRoles({
                    userRoles: {{ user_roles|JSON }},
            defaultRole: {{ default_role|JSON }},
    });
    $('#user-roles-table').show();
    });
</script>
{% endblock %}
{% block head %}
{{ block.super }}
<style>
</style>
{% endblock %}

{% block breadcrumb %}
        <li><span class="divider">&gt;</span> <a href="#">Members</a></li>
{% endblock %}

{% block org_content %}
<div class="row-fluid">
    <div>
        <h2>Members of Organization "{{ org.title }}"</h2>
        <table class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>{% trans "E-mail" %}</th>
                <th>{% trans "Role" %}</th>
                <th>{% trans "Name" %}</th>
                <th>{% trans "Phone Numbers" %}</th>
                <th>{% trans "Remove" %}</th>
            </tr>
            </thead>
            <tbody>
            {% for user, role in members %}
            <tr>
                <td>
                    {{ user.html_username|safe }}

                </td>
                <td>{% if role %}{{ role }}{% else %}<h6>(No Name)</h6>{% endif %}</td>
                <td>{{ user.first_name }} {{ user.last_name }}</td>
                <td>
                    {% if user.phone_numbers %}
                    +{{ user.default_phone_number }}
                    {% if user.phone_numbers.1 %}
                    (and more)
                    {% endif %}
                    {% else %}{% endif %}
                </td>
                <td>
                    {% ifnotequal request.user.username user.username %}
                    <a class="btn btn-danger" href="#remove_member_modal{{ user.get_id }}" data-toggle="modal"><i class="icon icon-white icon-remove"></i> Remove Membership</a>
                    <div id="remove_member_modal{{ user.get_id }}" class="modal hide fade">
                        <div class="modal-header">
                            <a class="close" data-dismiss="modal">&times;</a>
                            <h3>Are you sure you want to delete {% if user.name %}{{ user.name }}{% else %}{{ user.html_username|safe }}{% endif %} from {{ org.title }}?</h3>
                        </div>
                        <div class="modal-footer">
                            <form action="{% url orgs_remove_member org.name user.get_id %}" method="post">
                                <button type="submit" class="btn btn-danger"><i class="icon icon-white icon-remove"></i> Remove Membership</button>
                                <a href="#" data-dismiss="modal" class="btn">Cancel</a>
                            </form>
                        </div>
                        </form>
                    </div>
                    {% endifnotequal %}
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>

        <h2>Roles</h2>
        <div id="user-roles-table">
            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th></th>
                    <th>Edit Projects</th>
                    <th>Edit Teams</th>
                    <th>Edit Members</th>
                    <th>View Teams</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th>
                        <span>Admin</span>
                        <h6></h6>
                    </th>
                    <td><i class="icon-ok"></i></td>
                    <td><i class="icon-ok"></i></td>
                    <td><i class="icon-ok"></i></td>
                    <td><i class="icon-ok"></i></td>
                </tr>
                <tr>
                    <th>
                        <span>Team Manager</span>
                        <h6></h6>
                    </th>
                    <td></td>
                    <td><i class="icon-ok"></i></td>
                    <td><i class="icon-ok"></i></td>
                    <td><i class="icon-ok"></i></td>
                </tr>
                <tr>
                    <th>
                        <span>Project Manager</span>
                        <h6></h6>
                    </th>
                    <td><i class="icon-ok"></i></td>
                    <td></td>
                    <td><i class="icon-ok"></i></td>
                    <td></td>
                </tr>
                <tr>
                    <th>
                        <span>Member</span>
                        <h6></h6>
                    </th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td><i class="icon-ok"></i></td>
                </tr>
                    </td>
                    <!--<td>-->
                    <!--<button class="btn btn-danger" data-bind="visible: $data._id, click: $root.setRoleBeingEdited">-->
                    <!--<i class="icon-white icon-trash"></i>-->
                    <!--Delete Role-->
                    <!--</button>-->
                    <!--</td>-->
                </tr>
                </tbody>
            </table>
{% endblock %}

{% block modals %}
{% endblock %}